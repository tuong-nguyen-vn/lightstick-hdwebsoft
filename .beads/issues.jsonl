{"id":"lightstick-hdwebsoft-1","title":"Epic: Virtual Lightstick MVP","description":"# Virtual Lightstick MVP\n\n## Overview\nBuild a web-based virtual lightstick system allowing admin to control 300 devices simultaneously.\n\n## Acceptance Criteria\n- [ ] Admin can control solid color on all connected devices\n- [ ] Admin can send marquee text to all devices\n- [ ] Admin can trigger animation patterns (blink, pulse, fade)\n- [ ] All devices sync within 100ms\n- [ ] Room-based URL for easy sharing\n\n## Tech Stack\n- Frontend: React + Vite + TypeScript\n- Backend: Node.js + Fastify + WebSocket\n- Styling: TailwindCSS\n\n## Reference\n- [Approach Document](history/20260129-virtual-lightstick/approach.md)","status":"closed","priority":0,"issue_type":"epic","created_at":"2026-01-29T18:39:27.945259+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:42:07.717949+07:00","closed_at":"2026-01-29T18:42:07.717949+07:00","close_reason":"Epic started - planning complete"}
{"id":"lightstick-hdwebsoft-10","title":"Viewer App: Animation patterns (blink, pulse, fade)","description":"# Animation Patterns\n\n## Patterns to Implement\n\n### 1. Blink\n- On/off flashing\n- CSS: opacity toggle keyframes\n- Params: speed (fast/medium/slow)\n\n### 2. Pulse  \n- Brightness fade in/out\n- CSS: opacity 0.3 â†’ 1 â†’ 0.3\n- Params: speed, min opacity\n\n### 3. Fade\n- Color A â†’ Color B transition\n- CSS: transition background-color\n- Params: duration, fromColor, toColor\n\n### 4. Rainbow\n- Cycle through colors\n- CSS: hue-rotate animation or JS color array\n- Params: speed\n\n### 5. Strobe\n- Fast white flash\n- CSS: rapid opacity keyframes\n- Params: intensity\n\n## Component: PatternRenderer\n```tsx\nfunction PatternRenderer({ pattern, params, baseColor }: Props) {\n  switch(pattern) {\n    case 'blink': return \u003cBlinkEffect {...params} color={baseColor} /\u003e;\n    case 'pulse': return \u003cPulseEffect {...params} color={baseColor} /\u003e;\n    // ...\n  }\n}\n```\n\n## Files\n- apps/viewer/src/effects/patterns/blink.tsx\n- apps/viewer/src/effects/patterns/pulse.tsx\n- apps/viewer/src/effects/patterns/fade.tsx\n- apps/viewer/src/effects/patterns/rainbow.tsx\n- apps/viewer/src/effects/patterns/strobe.tsx\n- apps/viewer/src/effects/pattern-renderer.tsx\n\n## Acceptance Criteria\n- [ ] All 5 patterns work\n- [ ] Patterns are configurable\n- [ ] Smooth animations\n- [ ] No performance issues on mobile","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-29T18:40:39.124645+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:40:39.124645+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-10","depends_on_id":"lightstick-hdwebsoft-8","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-11","title":"Admin App: Setup React + Vite + TailwindCSS","description":"# Admin App Setup\n\n## Setup\n- React 18 + Vite + TypeScript\n- TailwindCSS\n- Mobile-responsive design\n\n## Basic Structure\n- apps/admin/src/App.tsx\n- apps/admin/src/main.tsx\n- apps/admin/tailwind.config.js\n\n## Initial Layout\n- Header with room info\n- Main control panel\n- Connection status indicator\n- Device count display\n\n## Acceptance Criteria\n- [ ] Dev server runs on port 5174\n- [ ] Responsive on mobile\n- [ ] Can import from @lightstick/shared","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-29T18:40:44.288258+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:40:44.288258+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-11","depends_on_id":"lightstick-hdwebsoft-3","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-12","title":"Admin App: WebSocket connection + Room creation","description":"# Admin WebSocket Integration\n\n## Features\n1. **Create Room**\n   - POST /api/rooms â†’ returns { roomCode, adminKey }\n   - Store adminKey in session/localStorage\n\n2. **Connect as Admin**\n   - ws://server/ws/{roomCode}/admin?key={adminKey}\n   - Receive device count updates\n   - Send state change commands\n\n## Hook: useAdminWebSocket\n```typescript\nfunction useAdminWebSocket(roomCode: string, adminKey: string) {\n  // Connect as admin\n  // Track connected device count\n  // Send commands\n  // Return: { deviceCount, isConnected, sendState }\n}\n```\n\n## API Endpoint (Server)\n- POST /api/rooms - Create new room\n- Response: { roomCode, adminKey, viewerUrl, adminUrl }\n\n## Files\n- apps/admin/src/hooks/use-admin-websocket.ts\n- apps/admin/src/api/rooms.ts\n- apps/server/src/routes/rooms.ts\n\n## Acceptance Criteria\n- [ ] Can create new room\n- [ ] Admin connects with secret key\n- [ ] Device count updates in real-time\n- [ ] Can send state changes","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-29T18:40:52.447163+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:40:52.447163+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-12","depends_on_id":"lightstick-hdwebsoft-5","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"lightstick-hdwebsoft-12","depends_on_id":"lightstick-hdwebsoft-11","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-13","title":"Admin App: Color picker control","description":"# Color Picker Control\n\n## Component: ColorControl\n- Color picker (hex input or color wheel)\n- Quick preset colors (Red, Blue, Green, Yellow, White, etc.)\n- Send button or auto-send on change\n\n## UI Design\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  ğŸ¨ Color Control               â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  [Color Picker Wheel/Input]     â”‚\nâ”‚                                 â”‚\nâ”‚  Presets:                       â”‚\nâ”‚  ğŸ”´ ğŸŸ¢ ğŸ”µ ğŸŸ¡ âšª ğŸŸ£ ğŸŸ            â”‚\nâ”‚                                 â”‚\nâ”‚  Current: #FF0000               â”‚\nâ”‚                                 â”‚\nâ”‚  [ Apply Color ]                â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Files\n- apps/admin/src/components/color-control.tsx\n- apps/admin/src/components/color-presets.tsx\n\n## Acceptance Criteria\n- [ ] Color picker works\n- [ ] Preset colors selectable\n- [ ] Sends state update on apply\n- [ ] Shows current active color","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-29T18:41:00.668135+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:41:00.668135+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-13","depends_on_id":"lightstick-hdwebsoft-12","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-14","title":"Admin App: Text marquee control","description":"# Text Marquee Control\n\n## Component: TextControl\n- Text input field\n- Speed selector (slow/medium/fast)\n- Text color picker\n- Background color picker\n\n## UI Design\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  ğŸ“ Text Marquee                â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  Text: [________________]       â”‚\nâ”‚                                 â”‚\nâ”‚  Speed:  â—‹ Slow â— Medium â—‹ Fast â”‚\nâ”‚                                 â”‚\nâ”‚  Text Color:    [â–  #FFFFFF]     â”‚\nâ”‚  Background:    [â–  #000000]     â”‚\nâ”‚                                 â”‚\nâ”‚  [ Send Text ]                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Files\n- apps/admin/src/components/text-control.tsx\n\n## Acceptance Criteria\n- [ ] Text input works\n- [ ] Speed selection works\n- [ ] Color pickers work\n- [ ] Sends marquee state on submit","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-29T18:41:07.492799+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:41:07.492799+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-14","depends_on_id":"lightstick-hdwebsoft-12","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-15","title":"Admin App: Pattern selector control","description":"# Pattern Selector Control\n\n## Component: PatternControl\n- Pattern preset buttons\n- Speed/intensity sliders per pattern\n- Preview indicator\n\n## UI Design\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  âœ¨ Animation Patterns          â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                 â”‚\nâ”‚  [ Blink ]  [ Pulse ]  [ Fade ] â”‚\nâ”‚  [Rainbow]  [Strobe]  [ Wave ]  â”‚\nâ”‚                                 â”‚\nâ”‚  Speed: [========â—‹===] Fast     â”‚\nâ”‚                                 â”‚\nâ”‚  Base Color: [â–  #FF0000]        â”‚\nâ”‚                                 â”‚\nâ”‚  [ â¹ Stop Animation ]          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Files\n- apps/admin/src/components/pattern-control.tsx\n- apps/admin/src/components/pattern-buttons.tsx\n\n## Acceptance Criteria\n- [ ] All patterns selectable\n- [ ] Speed slider works\n- [ ] Base color picker works\n- [ ] Stop button returns to solid color","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-29T18:41:14.70006+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:41:14.70006+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-15","depends_on_id":"lightstick-hdwebsoft-12","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-16","title":"Viewer App: Screen wake lock + Fullscreen","description":"# Screen Management\n\n## Features\n1. **Wake Lock API**\n   - Keep screen on during show\n   - Request on connect, release on disconnect\n   - Fallback: Show instruction to user\n\n2. **Fullscreen API**\n   - Button to go fullscreen\n   - Auto-request on first interaction\n   - iOS limitations: show instruction\n\n## Hook: useWakeLock\n```typescript\nfunction useWakeLock() {\n  // Request wake lock\n  // Handle visibility change (re-request on focus)\n  // Return: { isActive, request, release }\n}\n```\n\n## Component: FullscreenPrompt\n- Prompt user to tap for fullscreen\n- Hide after fullscreen achieved\n\n## Files\n- apps/viewer/src/hooks/use-wake-lock.ts\n- apps/viewer/src/hooks/use-fullscreen.ts\n- apps/viewer/src/components/fullscreen-prompt.tsx\n\n## Acceptance Criteria\n- [ ] Screen stays on (where supported)\n- [ ] Fullscreen works on Android\n- [ ] iOS shows helpful instruction\n- [ ] Graceful degradation","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-29T18:41:22.457784+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:41:22.457784+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-16","depends_on_id":"lightstick-hdwebsoft-7","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-17","title":"Admin App: Room info + QR code sharing","description":"# Room Sharing\n\n## Features\n1. **Room Info Display**\n   - Room code prominently displayed\n   - Viewer URL for sharing\n   - Connected device count\n\n2. **QR Code**\n   - Generate QR code for viewer URL\n   - Large enough to scan from distance\n   - Option to download/share\n\n## UI Design\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Room: ABC123                   â”‚\nâ”‚  Devices: 42 connected          â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                 â”‚\nâ”‚       â–„â–„â–„â–„â–„â–„â–„   â–„â–„â–„â–„â–„â–„â–„        â”‚\nâ”‚       â–ˆ â–„â–„â–„ â–ˆ â–„ â–ˆ â–„â–„â–„ â–ˆ        â”‚\nâ”‚       â–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–„â–„â–„â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ        â”‚\nâ”‚       â–ˆâ–„â–„â–„â–„â–„â–ˆ â–„ â–ˆâ–„â–„â–„â–„â–„â–ˆ        â”‚\nâ”‚       â–„ â–„ â–„â–„â–„â–„â–„â–„â–„â–„â–„ â–„ â–„        â”‚\nâ”‚       â–„â–„â–„â–„â–„â–„â–„â–ˆâ–„â–ˆâ–„â–ˆâ–„â–„â–„â–„â–„        â”‚\nâ”‚                                 â”‚\nâ”‚  Scan to join!                  â”‚\nâ”‚  lightstick.app/ABC123          â”‚\nâ”‚                                 â”‚\nâ”‚  [ Copy Link ] [ Share ]        â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Library\n- qrcode.react or similar\n\n## Files\n- apps/admin/src/components/room-info.tsx\n- apps/admin/src/components/qr-display.tsx\n\n## Acceptance Criteria\n- [ ] QR code generates correctly\n- [ ] Copy link works\n- [ ] Share button (where supported)\n- [ ] Device count real-time","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-29T18:41:32.681044+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:41:32.681044+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-17","depends_on_id":"lightstick-hdwebsoft-12","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-18","title":"Integration testing + E2E flow","description":"# Integration Testing\n\n## Test Scenarios\n\n### 1. Basic Flow\n- Admin creates room\n- Viewer joins via URL\n- Admin changes color â†’ Viewer displays color\n- Verify sync timing\n\n### 2. Multiple Viewers\n- Connect 5+ browser tabs as viewers\n- Admin sends command\n- All viewers update simultaneously\n\n### 3. Reconnection\n- Viewer disconnects (network drop)\n- Viewer reconnects\n- Receives current state\n\n### 4. Room Isolation\n- Create 2 rooms\n- Verify commands don't cross rooms\n\n## Manual Test Script\nCreate a test checklist for manual testing before deployment.\n\n## Files\n- docs/testing-checklist.md\n- scripts/test-multi-client.sh (optional)\n\n## Acceptance Criteria\n- [ ] All test scenarios documented\n- [ ] Basic flow verified working\n- [ ] Multi-viewer sync verified\n- [ ] Reconnection works","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-29T18:41:40.46207+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:41:40.46207+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-18","depends_on_id":"lightstick-hdwebsoft-8","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"lightstick-hdwebsoft-18","depends_on_id":"lightstick-hdwebsoft-13","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-19","title":"Deployment setup (Docker + Fly.io/Render)","description":"# Deployment Setup\n\n## Docker\n- Dockerfile for server (Node.js)\n- Docker compose for local testing\n- Build static assets into server\n\n## Cloud Deployment Options\n\n### Option A: Fly.io\n- fly.toml configuration\n- Single machine deployment\n- Auto-scaling disabled (keep simple)\n\n### Option B: Render\n- render.yaml\n- Web service + static site\n\n## Environment Variables\n- PORT\n- NODE_ENV\n- CORS_ORIGIN\n- ADMIN_SECRET_PREFIX (optional)\n\n## Files\n- Dockerfile\n- docker-compose.yml\n- fly.toml or render.yaml\n- .env.example\n\n## Acceptance Criteria\n- [ ] Docker build works\n- [ ] Can deploy to chosen platform\n- [ ] WebSocket works in production\n- [ ] HTTPS/WSS configured","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-29T18:41:47.996216+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:41:47.996216+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-19","depends_on_id":"lightstick-hdwebsoft-18","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-2","title":"Setup monorepo vá»›i pnpm workspaces + Turborepo","description":"# Setup Monorepo Structure\n\n## Tasks\n- Initialize pnpm workspace\n- Configure Turborepo for build orchestration\n- Create folder structure:\n  - apps/server\n  - apps/admin\n  - apps/viewer\n  - packages/shared\n\n## Files to Create\n- pnpm-workspace.yaml\n- turbo.json\n- tsconfig.base.json\n- .gitignore\n- .nvmrc (Node 20)\n\n## Acceptance Criteria\n- [ ] pnpm install works\n- [ ] turbo build works (even if apps are empty)\n- [ ] TypeScript configured with paths","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-29T18:39:40.018741+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:39:40.018741+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-2","depends_on_id":"lightstick-hdwebsoft-1","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-3","title":"Shared package: Types vÃ  Constants","description":"# Shared Package\n\n## Files\n- packages/shared/src/types.ts\n- packages/shared/src/patterns.ts\n- packages/shared/src/constants.ts\n\n## Types to Define\n```typescript\n// State types\ninterface LightstickState {\n  mode: 'color' | 'text' | 'pattern';\n  color?: string;\n  text?: string;\n  textSpeed?: number;\n  pattern?: PatternType;\n  patternParams?: PatternParams;\n}\n\n// Message types\ninterface StateUpdate {\n  version: number;\n  serverNow: number;\n  startAt: number;\n  state: LightstickState;\n}\n\n// Pattern types\ntype PatternType = 'blink' | 'pulse' | 'fade' | 'rainbow' | 'wave' | 'strobe';\n\ninterface PatternParams {\n  speed?: number;\n  colors?: string[];\n  intensity?: number;\n}\n```\n\n## Acceptance Criteria\n- [ ] Types exported correctly\n- [ ] Can be imported by server/admin/viewer","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-29T18:39:46.52027+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:39:46.52027+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-3","depends_on_id":"lightstick-hdwebsoft-2","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-4","title":"WebSocket Server: Core setup + Room management","description":"# WebSocket Server Core\n\n## Setup\n- Fastify server with @fastify/websocket\n- Room-based connection management\n- State broadcasting\n\n## Core Features\n1. **Room Management**\n   - Generate room code (6 chars alphanumeric)\n   - Track connections per room\n   - Cleanup empty rooms\n\n2. **Connection Handling**\n   - /ws/{roomCode} - Viewer connection\n   - /ws/{roomCode}/admin?key={secret} - Admin connection\n   - Heartbeat ping every 20s\n   - Auto-disconnect on timeout\n\n3. **State Management**\n   - Store current state per room\n   - Version counter for ordering\n   - Broadcast to all viewers in room\n\n## Files\n- apps/server/src/index.ts\n- apps/server/src/ws/room-manager.ts\n- apps/server/src/ws/handlers.ts\n- apps/server/src/state/store.ts\n\n## Acceptance Criteria\n- [ ] Server starts on port 3001\n- [ ] Can connect via WebSocket\n- [ ] Room isolation works (room A doesn't see room B)\n- [ ] Heartbeat keeps connections alive","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-29T18:39:54.333167+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:39:54.333167+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-4","depends_on_id":"lightstick-hdwebsoft-3","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-5","title":"WebSocket Server: Time sync protocol","description":"# Time Sync Protocol\n\n## Purpose\nEnsure all clients apply state changes at the same moment for synchronized effects.\n\n## Implementation\n\n### Server Side\n- Include serverNow timestamp in all messages\n- Calculate startAt = serverNow + SYNC_DELAY (300ms)\n- Track message version for ordering\n\n### Protocol Messages\n```typescript\n// Server â†’ Client\ninterface StateUpdateMessage {\n  type: 'STATE_UPDATE';\n  version: number;\n  serverNow: number;\n  startAt: number;\n  state: LightstickState;\n}\n\n// Client â†’ Server (for offset calculation)\ninterface PingMessage {\n  type: 'PING';\n  clientTime: number;\n}\n\n// Server â†’ Client\ninterface PongMessage {\n  type: 'PONG';\n  clientTime: number;\n  serverTime: number;\n}\n```\n\n## Files\n- apps/server/src/ws/protocol.ts\n- apps/server/src/ws/time-sync.ts\n\n## Acceptance Criteria\n- [ ] Messages include timestamp fields\n- [ ] Ping/pong works for offset calculation\n- [ ] startAt is consistently SYNC_DELAY after serverNow","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-29T18:40:01.994718+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:40:01.994718+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-5","depends_on_id":"lightstick-hdwebsoft-4","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-6","title":"Viewer App: Setup React + Vite + TailwindCSS","description":"# Viewer App Setup\n\n## Setup\n- React 18 + Vite + TypeScript\n- TailwindCSS\n- Import shared types\n\n## Basic Structure\n- apps/viewer/src/App.tsx\n- apps/viewer/src/main.tsx\n- apps/viewer/tailwind.config.js\n- apps/viewer/vite.config.ts\n\n## Initial App\n- Full screen container\n- Connect to WebSocket based on URL roomCode\n- Display connection status\n\n## Acceptance Criteria\n- [ ] Dev server runs on port 5173\n- [ ] TailwindCSS works\n- [ ] Can import from @lightstick/shared","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-29T18:40:09.253757+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:40:09.253757+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-6","depends_on_id":"lightstick-hdwebsoft-3","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-7","title":"Viewer App: WebSocket hook + Time sync","description":"# Viewer WebSocket Integration\n\n## Hook: useWebSocket\n```typescript\nfunction useWebSocket(roomCode: string) {\n  // Connect to ws://server/ws/{roomCode}\n  // Auto-reconnect on disconnect\n  // Return: { state, isConnected, serverOffset }\n}\n```\n\n## Hook: useTimeSync\n```typescript\nfunction useTimeSync(ws: WebSocket) {\n  // Periodic ping to calculate server offset\n  // serverOffset = serverTime - clientTime\n  // Return: { serverOffset, issynced }\n}\n```\n\n## Hook: useScheduledState\n```typescript\nfunction useScheduledState(state: StateUpdate, serverOffset: number) {\n  // Schedule state application at startAt\n  // Use setTimeout with corrected time\n  // Return: { activeState }\n}\n```\n\n## Files\n- apps/viewer/src/hooks/use-websocket.ts\n- apps/viewer/src/hooks/use-time-sync.ts\n- apps/viewer/src/hooks/use-scheduled-state.ts\n\n## Acceptance Criteria\n- [ ] Auto-connect on mount\n- [ ] Auto-reconnect on disconnect\n- [ ] Server offset calculated correctly\n- [ ] State applied at scheduled time","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-29T18:40:16.81766+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:40:16.81766+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-7","depends_on_id":"lightstick-hdwebsoft-5","type":"blocks","created_at":"0001-01-01T00:00:00Z"},{"issue_id":"lightstick-hdwebsoft-7","depends_on_id":"lightstick-hdwebsoft-6","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-8","title":"Viewer App: Solid color effect","description":"# Solid Color Effect\n\n## Component: ColorDisplay\nFull screen div vá»›i background color tá»« state.\n\n```tsx\nfunction ColorDisplay({ color }: { color: string }) {\n  return (\n    \u003cdiv \n      className=\"fixed inset-0 transition-colors duration-200\"\n      style={{ backgroundColor: color }}\n    /\u003e\n  );\n}\n```\n\n## Features\n- Smooth color transition (CSS transition)\n- Full viewport coverage\n- Handle edge cases (invalid color)\n\n## Files\n- apps/viewer/src/effects/color-display.tsx\n\n## Acceptance Criteria\n- [ ] Full screen solid color\n- [ ] Smooth transitions between colors\n- [ ] Works on mobile browsers","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-29T18:40:22.800123+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:40:22.800123+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-8","depends_on_id":"lightstick-hdwebsoft-7","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
{"id":"lightstick-hdwebsoft-9","title":"Viewer App: Marquee text effect","description":"# Marquee Text Effect\n\n## Component: MarqueeText\nScrolling text across screen.\n\n```tsx\nfunction MarqueeText({ text, speed, color }: Props) {\n  // CSS animation for horizontal scroll\n  // Configurable speed\n  // Text color and background color\n}\n```\n\n## Implementation Options\n1. **CSS Animation** (preferred)\n   - translateX from 100% to -100%\n   - animation-duration based on speed\n   \n2. **Canvas** (if CSS inconsistent)\n   - requestAnimationFrame\n   - Consistent across devices\n\n## Files\n- apps/viewer/src/effects/marquee-text.tsx\n\n## Acceptance Criteria\n- [ ] Text scrolls smoothly\n- [ ] Speed is configurable\n- [ ] Large readable font\n- [ ] Loops continuously","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-29T18:40:29.056459+07:00","created_by":"tuongnguyen","updated_at":"2026-01-29T18:40:29.056459+07:00","dependencies":[{"issue_id":"lightstick-hdwebsoft-9","depends_on_id":"lightstick-hdwebsoft-7","type":"blocks","created_at":"0001-01-01T00:00:00Z"}]}
